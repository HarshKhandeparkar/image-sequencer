!function(){return function e(t,i,n){function r(a,s){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=i[a]={exports:{}};t[a][0].call(d.exports,function(e){return r(t[a][1][e]||e)},d,d.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}}()({1:[function(e,t,i){var n=e("./lib/sequencer/sequence/defaultHtmlSequencerUi"),r=e("./lib/sw/cache.js"),o=e("./lib/sequencer/step/defaultHtmlStepUi.js"),{setModuleSelector:a}=e("./lib/sequencer/sequence/setModuleSelector"),{getUrlHashParameter:s}=e("./lib/sequencer/sequence/urlHash.js"),{initializeSelect:l,initializeModal:c,initializeTooltips:d}=e("./lib/DOM/initializeComponents"),{setScrollBtn:u,setCacheShortcut:p}=e("./lib/DOM/helpers"),m=e("./lib/sequencer/sequence/gif"),f=e("./lib/sequencer/sequence/saveSequence");insertPreview=e("./lib/DOM/insertPreview"),window.onload=function(){sequencer=ImageSequencer(),$("#file-input-label").on("click",function(e){$("#fileInput").click()}),$("button#old-ui").on("click",function(){var e=window.location.toString(),t=e.substr(0,e.indexOf("examples/")+9)+"legacy/#steps="+s("steps");window.location=t}),u("#move-up"),p(),d(),f(),sequencer.setUI(o(sequencer));var e=n(sequencer);a(e),s("src")?sequencer.loadImage(s("src"),e.onLoad):sequencer.loadImage("images/tulips.png",e.onLoad);$("#resetButton").on("click",function(){confirm("Do you want to reset the sequence?")&&(window.location="/")}),$("#download-btn").click(function(){return download($(".step-thumbnail:last()").attr("src"),$(".step-thumbnail:last()").attr("alt")+".png","image/png"),!1}),$("body").on("click","button.remove",e.removeStepUi),m(),sequencer.setInputStep({dropZoneSelector:"#dropzone",fileInputSelector:"#fileInput",takePhotoSelector:"#take-photo",onLoad:function(e){var t=e.target,i=sequencer.images.image1.steps[0];i.output.src=t.result,sequencer.run({index:0}),i.options.step.imgElement.src=t.result,insertPreview.updatePreviews(t.result,"#addStep"),insertPreview.updatePreviews(sequencer.images.image1.steps[0].options.step.imgElement.src,".insert-step")},onTakePhoto:function(e){var t=sequencer.images.image1.steps[0];t.output.src=e,sequencer.run({index:0}),t.options.step.imgElement.src=e}}),r(),s("src")?insertPreview.updatePreviews(s("src"),"#addStep"):insertPreview.updatePreviews("images/tulips.png","#addStep"),l(),c()}},{"./lib/DOM/helpers":3,"./lib/DOM/initializeComponents":5,"./lib/DOM/insertPreview":6,"./lib/sequencer/sequence/defaultHtmlSequencerUi":7,"./lib/sequencer/sequence/gif":8,"./lib/sequencer/sequence/saveSequence":9,"./lib/sequencer/sequence/setModuleSelector":10,"./lib/sequencer/sequence/urlHash.js":11,"./lib/sequencer/step/defaultHtmlStepUi.js":12,"./lib/sw/cache.js":15}],2:[function(e,t,i){function n(e,t,i,n){var r=!(isNaN(i)||isNaN(t)?t===i:t-i==0);return e.changedInputs+=n?r?0:-1:r?1:0,e.optionsChanged=e.changedInputs>0,$(e.ui.querySelector(".btn-save")).prop("disabled",!e.optionsChanged),r}t.exports={handleInputValueChange:n,updateInputs:function(e){$(e).each((e,t)=>{$(t).data("initValue",$(t).val()).data("hasChangedBefore",!1)})},initializeInputs:function(e,t){$(e).data("initValue",$(e).val()).data("hasChangedBefore",!1).on("input change",function(){$(e).focus().data("hasChangedBefore",n(t,$(e).val(),$(e).data("initValue"),$(e).data("hasChangedBefore")))})}}},{}],3:[function(e,t,i){t.exports={Collapse:function(e,t){switch(t){case"show":$(e).addClass("custom-show");break;case"hide":$(e).removeClass("custom-show");break;default:$(e).toggleClass("custom-show")}},notify:function(e,t,i=200){if(0==$("#"+t).length){var n=document.createElement("span");n.innerHTML='<b><i class="material-icons">info</i> '+e+"</b>",n.id=t,n.classList.add("notification"),$("body").append(n)}$("#"+t).fadeIn(500).delay(i).fadeOut(500)},setScrollBtn:function(e){$(document).ready(function(t){t(function(){t(window).scroll(function(){t(this).scrollTop()>100?t(e).fadeIn():t(e).fadeOut()}),t(e).click(function(){return t("body,html").animate({scrollTop:0},800),!1})})}),$(e).on("click",function(){$("body").animate({scrollTop:0}),$(":root").animate({scrollTop:0})})},setCacheShortcut:function(){var e=!1,t=!1,i={ctrlcmd:[17,91,93,224],E:69};function n(t){e||i.ctrlcmd.includes(t.which)&&(e=!0,$(document).off("keydown"),$(document).on("keydown",r))}function r(n){e&&!t&&n.which==i.E&&$("#clear-cache").click()}$(document).on("keydown",n),$(document).on("keyup",function(r){(i.ctrlcmd.includes(r.which)||r.which==i.E)&&(e=!1,t=!1,$(document).off("keydown"),$(document).on("keydown",n))})}}},{}],4:[function(e,t,i){t.exports={getStepTemplate:function(e){return'<li class="active step-wrapper">            <div class="collapsible-header"><b>'+((t=e.name).charAt(0).toUpperCase()+t.substr(1))+'</b></div>            <div class="collapsible-body" style="display:block;">              <div class="container">                <div class="row step">                  <form class="input-form">                    <div class="col m4 details">                      <div>                        <p>                          <i>'+(e.description||"")+'</i>                        </p>                      </div>                    </div>                  </form>                  <div class="col m8">                    <div class="load" style="display:none;"><i class="material-icons spin toggleIcon">donut_large</i></div>                    <img style="max-width=100%" class="img-thumbnail step-thumbnail responsive-img materialboxed"/>                    </div>                  </div>                </div>              </div>            </div>          </li>';var t},toolsTemplate:'<div>                      <div class="tools right">                        <button class="btn download-step-btn btn-floating waves-effect waves-light blue darken-3 z-depth-0">                          <i class="material-icons">file_download</i>                        </button>                        <button class="remove btn-floating waves-effect waves-light red z-depth-0">                          <i class="material-icons">delete</i>                        </button>                        <button class="btn insert-step-btn btn-floating waves-effect waves-light green z-depth-0">                          <span class="insert-text">                            <i class="material-icons">add_circle</i>                          </span>                          <span class="no-insert-text" style="display:none;">                            <i class="material-icons">remove_circle</i>                          </span>                        </button>                      </div>                    </div>',stepInsertTemplate:'<div class="row center-align insertDiv flex-collapse" style="display:none;">                            <div class="col s8 center-align" style="margin-top:5%;margin-left:0;">                              <section class="insert-step card">                                <div class="form-inline">                                  <div class="card-content center">                                    <span class="card-title">Select A Module</span>                                    <p class="info"></p>                                    <div class="row center-align radio-group">                                    <div>                                      <div class="radio" data-value="brightness">                                        <i class="material-icons i-over">brightness_high</i>                                      </div>                                      <p>Brightness</p>                                      </div>                                      <div>                                        <div class="radio" data-value="contrast">                                          <i class="material-icons i-over">tonality</i>                                        </div>                                        <p>Contrast</p>                                      </div>                                      <div>                                        <div class="radio" data-value="saturation">                                          <i class="material-icons i-over">colorize</i>                                        </div>                                        <p>Saturation</p>                                      </div>                                      <div>                                        <div class="radio" data-value="rotate">                                          <i class="material-icons i-over">rotate_left</i>                                        </div>                                        <p>Rotate</p>                                      </div>                                      <div>                                        <div class="radio" data-value="crop">                                          <i class="material-icons i-over">crop</i>                                        </div>                                        <p>Crop</p>                                      </div>                                    </div>                                    <div class="center input-field center-align">                                      <select>                                        \x3c!-- The default null selection has been appended manually in demo.js                                        This is because the options in select are overritten when options are appended.--\x3e                                      </select>                                    </div>                                    <button class="btn waves-effect green accent-4 add-step-btn" name="add">Add Step</button>                                  </div>                                </div>                              </section>                            </div>                          </div>'}},{}],5:[function(e,t,i){function n(){M.FormSelect.init(document.querySelectorAll("select"),{}),$(".dropdown-content>li>span, .select-dropdown").addClass("blue-grey-text")}function r(){$(".modal").modal()}function o(){var e=document.querySelector(".collapsible.expandable");M.Collapsible.init(e,{accordion:!1})}function a(){var e=document.querySelectorAll("input[type=range]");M.Range.init(e)}function s(){var e=document.querySelectorAll(".materialboxed");M.Materialbox.init(e,{})}function l(){M.updateTextFields()}function c(){$("textarea").length>0&&M.textareaAutoResize($("textarea"))}function d(){var e=document.querySelectorAll(".tooltipped");M.Tooltip.init(e,{})}t.exports={initializeSelect:n,initializeModal:r,initializeCollapsible:o,initializeMaterialBoxImg:s,initializeRange:a,initializeTextInputs:l,updateTextArea:c,initializeTooltips:d,initializeAll:function(){o(),r(),n(),a(),s(),l(),c(),d()}}},{}],6:[function(e,t,i){function n(e,t,i,n){var r=ImageSequencer();function o(t){var i=document.createElement("img");i.classList.add("preview-thumbnail"),i.src=t;$(n+" .radio-group").find("div").each(function(){$(this).find(".radio").attr("data-value")===e&&$(this).find(".radio").append(i)})}r.loadImage(i,function(){r=r.addSteps("resize",{resize:"40%"}),"crop"===e?r.addSteps(e,t).run(o):r.addSteps(e,{[e]:t}).run(o)})}t.exports={generatePreview:n,updatePreviews:function(e,t){$(t+" img").remove();var i={brightness:"20",saturation:"5",rotate:90,contrast:90,crop:{x:0,y:0,w:"(50%)",h:"(50%)",noUI:!0}};Object.keys(i).forEach(function(r,o){n(r,Object.values(i)[o],e,t)})}}},{}],7:[function(e,t,i){var n=e("./urlHash.js");t.exports=function(e,t){var i=(t=t||{}).addStepSel=t.addStepSel||"#addStep",r=t.removeStepSel=t.removeStepSel||"button.remove";function o(){var t=n.getUrlHashParameter("steps");t&&(e.importString(t),e.run({index:0})),n.setUrlHashParameter("steps",sequencer.toString())}function a(){sequencer.images.image1.steps.length<2?$(" #save-seq").prop("disabled",!0):$(" #save-seq").prop("disabled",!1)}return t.selectStepSel=t.selectStepSel||"#selectStep",{onLoad:function(){o(),$("#selectStep").val()||$(i+" #add-step-btn").prop("disabled",!0),a()},importStepsFromUrlHash:o,selectNewStepUi:function(){var t=$(i+" select").val();$(i+" .info").html(e.modulesInfo(t).description),$(i+" #add-step-btn").prop("disabled",!1)},removeStepUi:function(){var e=$(r).index(this)+1;sequencer.removeSteps(e).run({index:e-1}),n.setUrlHashParameter("steps",sequencer.toString()),a()},addStepUi:function(){if("none"!=$(i+" select").val()){var r=$(i+" select").val(),o=1;sequencer.sequences[r]?o=sequencer.sequences[r].length:sequencer.modules[r][1].length&&(o=sequencer.modules[r][1].length),e.addSteps(r,t).run({index:e.images.image1.steps.length-o-1}),$(i+" .info").html("Select a new module to add to your sequence."),a(),n.setUrlHashParameter("steps",e.toString())}}}}},{"./urlHash.js":11}],8:[function(e,t,i){var n=e("gifshot");t.exports=function(){var e=!1;$(".js-view-as-gif").on("click",function(t){if(!e){e=!0;var i=t.target;i.disabled=!0;try{for(var r=document.getElementsByClassName("step-thumbnail"),o=[],a=0;a<r.length;a++)o.push(r[a].src);var s={gifWidth:r[0].width,gifHeight:r[0].height,images:o,frameDuration:7};n.createGIF(s,function(t){if(!t.error){var n=t.image,r=document.createElement("img");r.classList.add("responsive-img"),r.src=n;var o=$("#js-download-gif-modal");$("#js-download-as-gif-button").one("click",function(){o.modal("close"),download(n,"index.gif","image/gif")}),$(".gif-close").click(function(){o.modal("close")});var a=document.getElementById("js-download-modal-gif-container");a.innerHTML="",a.appendChild(r),o.modal("open"),i.disabled=!1,e=!1}})}catch(t){console.error(t),i.disabled=!1,e=!1}}})}},{gifshot:16}],9:[function(e,t,i){var{notify:n}=e("../../DOM/helpers"),{refreshOptions:r}=e("./setModuleSelector");t.exports=function(){$("#save-seq").click(()=>{var e=window.prompt("Please give a name to your sequence... (Saved sequence will only be available in this browser).");e&&(e+=" (local)",sequencer.saveSequence(e,sequencer.toString()),sequencer.loadModules(),n("Saved Sequence Success. Sequence can be found among other modules.","save-seq-notification",1e3),r())})}},{"../../DOM/helpers":3,"./setModuleSelector":10}],10:[function(e,t,i){function n(){var e=sequencer.modulesInfo(),t=$("#selectStep");for(var i in t.html(""),e)e[i]&&e[i].name&&t.append('<option value="'+i+'">'+e[i].name+"</option>");t.append('<option value="none" disabled selected>More modules...</option>')}t.exports={setModuleSelector:function(e){n(),function(e){$(".radio-group .radio").on("click",function(){$(this).parent().find(".radio").removeClass("selected"),$(this).addClass("selected"),newStep=$(this).attr("data-value"),$("#addStep select").val(newStep),e.selectNewStepUi(),e.addStepUi(),$(this).removeClass("selected")})}(e),$("#addStep select").on("change",e.selectNewStepUi),$("#addStep #add-step-btn").on("click",e.addStepUi)},refreshOptions:n}},{}],11:[function(e,t,i){function n(){var e=window.location.hash;e&&(e=e.split("#")[1]);var t={};return(e.includes("&")?e.split("&"):[e]).forEach(function(e,i){""!=(e=e.split("="))[0]&&(t[e[0]]=e[1])}),t}function r(e){var t=Object.keys(e),i=Object.values(e),n=[];t.forEach(function(e,r){""!=e&&n.push(t[r]+"="+i[r])});var r=n.join("&");window.location.hash=r}t.exports={getUrlHashParameter:function(e){return n()[e]},setUrlHashParameter:function(e,t){var i=n();i[e]=t,r(i)},getUrlHashParameters:n,setUrlHashParameters:r}},{}],12:[function(e,t,i){var n=e("../step/intermediateHtmlStepUi"),r=e("../sequence/urlHash"),o=e("./mapHtmlTypes"),{notify:a}=e("../../DOM/helpers"),s=e("../../DOM/initializeComponents").initializeAll,{initializeInputs:l,updateInputs:c}=e("../../DOM/handleInputChanges"),{updateTextArea:d}=e("../../DOM/initializeComponents"),{getStepTemplate:u,toolsTemplate:p}=e("../../DOM/htmlTemplates");function m(e,t){var i=(t=t||{}).stepsEl||document.querySelector("#steps ul");return{getPreview:function(){return step.imgElement},onSetup:function(t,m){t.options&&t.options.description&&(t.description=t.options.description),t.ui=u(t);var f,g=p,h=n(e,t),v=new DOMParser;if(t.ui=v.parseFromString(t.ui,"text/html"),t.ui=t.ui.querySelector(".step-wrapper"),t.linkElements=t.ui.querySelectorAll("a"),t.imgElement=t.ui.querySelector(".step-thumbnail"),t.imgElement.alt=t.name,e.modulesInfo().hasOwnProperty(t.name)){var b=e.modulesInfo(t.name).inputs,S=e.modulesInfo(t.name).outputs,w=Object.assign(b,S);for(var y in w){var x=b.hasOwnProperty(y),q="",C=x?o(b[y]):{};if(x)if("select"==C.type){for(var k in q+=`<div name="${y} class="input-field"><select class="target" name="${y}">`,C.values)q+=`<option value="${C.values[k]}">${C.values[k]}</option>`;q+="</select></div>"}else{let e=t.options[y]||C.default;"text"==C.type?q+=`<div class="input-field">\n                <textarea\n                  class="materialize-textarea target"                  name="${y}"\n                  id="${y}"\n                  placeholder="${C.placeholder||""}"\n                >${e}</textarea`:q+=`<div class="input-field">                <input class="validate target"                  type="${C.type}"\n                  name="${y}"\n                  id="${y}"\n                  value="${e}"\n                  placeholder ="${C.placeholder||""}"`,"range"==C.type?q+=`\n            min="${C.min}"\n            max="${C.max}"\n            step="${C.step?C.step:"1"}">\n            </div>`:q+=`><label for="${y}">${f=y,f.charAt(0).toUpperCase()+f.substr(1)}</label></div>`}else q+='<span class="output"></span>';var O=document.createElement("div");O.className="row",O.setAttribute("name",y);var M=C.desc||"";O.innerHTML=`\n        <div class="det">          <span>${M}</span>\n          ${q}\n        </div>`,t.ui.querySelector("div.details").appendChild(O)}$(t.ui.querySelector("div.details")).append('<div class="cal"><p><button type="submit" class="btn btn-save" disabled="true" >Apply</button><span> Press apply to see changes</span></p></div>')}"load-image"!=t.name?(t.ui.querySelector("div.details").appendChild(v.parseFromString(g,"text/html").querySelector("div")),$(t.ui.querySelectorAll(".remove")).on("click",function(){a("Step Removed","remove-notification")}),$(t.ui.querySelectorAll(".insert-step-btn")).on("click",function(){h.insertStep(t.ID)}),m.index==e.images.image1.steps.length?($(i).append(t.ui),$("#steps ul li:nth-last-child(1) .insert-step-btn").prop("disabled",!0),$("#steps ul li:nth-last-child(2)")&&$("#steps ul li:nth-last-child(2) .insert-step-btn").prop("disabled",!1)):i.insertBefore(t.ui,$(i).children()[m.index])):$(i).append(t.ui),t.changedInputs=0,t.optionsChanged=!1,$(t.ui.querySelector(".input-form")).on("submit",function(i){i.preventDefault(),t.optionsChanged&&($(t.ui.querySelector("div.details")).find("input,select,textarea").each(function(e,i){c(i),t.options[$(i).attr("name")]=$(i).val()}),e.run({index:t.index-1}),r.setUrlHashParameter("steps",e.toString()),$(t.ui.querySelector(".btn-save")).prop("disabled",!0),t.optionsChanged=!1,t.changedInputs=0,d())}),$(t.ui.querySelectorAll(".target")).each(function(e,i){l(i,t)}),s()},onComplete:function(t){$(t.ui.querySelector(".load")).hide(),$(t.ui.querySelector("img")).show(),$(t.ui.querySelector(".load-spin")).hide(),t.imgElement.src=t.output,$(t.ui.querySelector(".download-step-btn")).on("click",function(){download(t.output,t.name+".png","image/png")});var i=t.ui.querySelector(".img-thumbnail");for(let e=0;e<t.linkElements.length;e++)t.linkElements[e].contains(i)&&(t.linkElements[e].href=t.output);for(let e=0;e<t.linkElements.length;e++)t.linkElements[e].download=t.name+"."+t.output.split("/")[1].split(";")[0],t.linkElements[e].target="_blank";if(e.modulesInfo().hasOwnProperty(t.name)){var n=e.modulesInfo(t.name).inputs,r=e.modulesInfo(t.name).outputs;for(var o in n)void 0!==t.options[o]&&("input"===n[o].type.toLowerCase()&&$(t.ui.querySelector('div[name="'+o+'"] input')).val(t.options[o]).data("initValue",t.options[o]),"input"===n[o].type.toLowerCase()&&$(t.ui.querySelector('div[name="'+o+'"] textarea')).val(t.options[o]).data("initValue",t.options[o]),"select"===n[o].type.toLowerCase()&&$(t.ui.querySelector('div[name="'+o+'"] select')).data("initValue",t.options[o]).find('option[value="'+t.options[o]+'"]').prop("selected",!0),$(t.ui.querySelector('div[name="'+o+'"] select')).formSelect());for(var o in r)void 0!==t[o]&&$(t.ui.querySelector('div[name="'+o+'"] input textarea')).val(t[o])}d()},onRemove:function(e){e.ui.remove(),$("#steps .container:nth-last-child(1) .insert-step-btn").prop("disabled",!0),$("div[class^=imgareaselect-]").remove()},onDraw:function(e){$(e.ui.querySelector(".load")).show(),$(e.ui.querySelector("img")).hide(),$(e.ui.querySelector(".toggleIcon")).hasClass("fa-caret-down")&&$(e.ui.querySelector(".load-spin")).show()},notify:a}}"undefined"==typeof window&&(t.exports={DefaultHtmlStepUi:m}),t.exports=m},{"../../DOM/handleInputChanges":2,"../../DOM/helpers":3,"../../DOM/htmlTemplates":4,"../../DOM/initializeComponents":5,"../sequence/urlHash":11,"../step/intermediateHtmlStepUi":13,"./mapHtmlTypes":14}],13:[function(e,t,i){var n=e("../sequence/urlHash"),r=e("../../DOM/initializeComponents").initializeSelect,{updatePreviews:o}=e("../../DOM/insertPreview"),{Collapse:a}=e("../../DOM/helpers"),{stepInsertTemplate:s}=e("../../DOM/htmlTemplates");t.exports=function(e,t,i){function l(t){i=i||{};var r=$(".insert-step select");if("none"!=r.val()){var o=r.val();$("div.insertDiv").remove(),sequencer.sequences[o]?sequencer.sequences[o].length:sequencer.modules[o][1].length&&sequencer.modules[o][1].length,e.insertSteps(t+1,o).run({index:t}),n.setUrlHashParameter("steps",e.toString())}}function c(){if($(t.ui.querySelector("div.insertDiv")).length>0)return window.step=t.ui,void $(t.ui.querySelector("div.insertDiv")).collapse("toggle");t.ui.querySelector("div.step").insertAdjacentElement("afterend",addStepUI),$(t.ui.querySelector("div.insertDiv").collapse("toggle"));var i=$(".insert-step select").val();$(".insert-step .info").html(e.modulesInfo(i).description),$(".insert-step .add-step-btn").prop("disabled",!1)}return insertStep=function(i){var n=e.modulesInfo(),d=new DOMParser,u=s;u=d.parseFromString(u,"text/html").querySelector("div");var p=function(e){$(t.ui.querySelector(".insert-step-btn")).animate({opacity:.5},200).toggleClass("green").toggleClass("amber").animate({opacity:1},200),a($(t.ui.querySelector(".insertDiv")).fadeToggle(200),"toggle"),"none"!=$(t.ui.querySelector(".insert-text")).css("display")?$(t.ui.querySelector(".insert-text")).fadeToggle(200,function(){$(t.ui.querySelector(".no-insert-text")).fadeToggle(200,e)}):$(t.ui.querySelector(".no-insert-text")).fadeToggle(200,function(){$(t.ui.querySelector(".insert-text")).fadeToggle(200,e)})};$(t.ui.querySelector(".insertDiv")).length>0?p():(t.ui.querySelector("div.step").insertAdjacentElement("afterend",u),p(function(){o(t.output,".insert-step")}));var m=$(".insert-step select");for(var f in m.html(""),n)void 0!==n[f]&&m.append('<option value="'+f+'">'+n[f].name+"</option>");$(".insert-step .add-step-btn").prop("disabled",!0),m.append('<option value="none" disabled selected>More modules...</option>'),$(".insert-step .radio-group .radio").on("click",function(){$(this).parent().find(".radio").removeClass("selected"),$(this).addClass("selected"),newStep=$(this).attr("data-value"),m.val(newStep),c(),l(i),$(this).removeClass("selected")}),$(t.ui.querySelector(".insert-step select")).on("change",c),$(t.ui.querySelector(".insert-step .add-step-btn")).on("click",function(){l(i)}),r()},{insertStep:insertStep}}},{"../../DOM/helpers":3,"../../DOM/htmlTemplates":4,"../../DOM/initializeComponents":5,"../../DOM/insertPreview":6,"../sequence/urlHash":11}],14:[function(e,t,i){t.exports=function(e){var t;switch(e.type.toLowerCase()){case"integer":t=void 0!=e.min?"range":"number";break;case"select":t="select";break;case"percentage":t="number";break;case"float":t=void 0!=e.min?"range":"text";break;case"range":t="range";break;case"number":t="number";break;default:t="text"}return{...e,type:t}}},{}],15:[function(e,t,i){t.exports=function(){"serviceWorker"in navigator&&navigator.serviceWorker.register("sw.js",{scope:"/examples/new/"}).then(function(e){const t=e.installing;t.onstatechange=(()=>{console.log(t),"installed"===t.state&&location.reload()}),console.log("Registration successful, scope is:",e.scope)}).catch(function(e){console.log("Service worker registration failed, error:",e)}),"serviceWorker"in navigator&&caches.keys().then(function(e){e.forEach(function(e){$("#clear-cache").append(" "+e)})}),$("#clear-cache").click(function(){"serviceWorker"in navigator&&caches.keys().then(function(e){e.forEach(function(e){caches.delete(e)})}),location.reload()})}},{}],16:[function(e,t,i){!function(e,n,r,o){"use strict";var a,s,l={URL:e.URL||e.webkitURL||e.mozURL||e.msURL,getUserMedia:(s=r.getUserMedia||r.webkitGetUserMedia||r.mozGetUserMedia||r.msGetUserMedia,s?s.bind(r):s),requestAnimFrame:e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||l.noop,t=t||0,!l.requestAnimFrame)return setTimeout(e,t);var i=(new Date).getTime(),n=new Object,r=l.requestAnimFrame;return n.value=r(function o(){(new Date).getTime()-i>=t?e.call():n.value=r(o)}),n},Blob:e.Blob||e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,btoa:(a=e.btoa||function(e){for(var t="",i=0,n=e.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,a=void 0,s=void 0,l=void 0,c=void 0,d=void 0,u=void 0;i<n;)l=(o=e.charCodeAt(i++))>>2,c=(3&o)<<4|(a=e.charCodeAt(i++))>>4,d=(15&a)<<2|(s=e.charCodeAt(i++))>>6,u=63&s,isNaN(a)?d=u=64:isNaN(s)&&(u=64),t=t+r.charAt(l)+r.charAt(c)+r.charAt(d)+r.charAt(u);return t},a?a.bind(e):l.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return l.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=n.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return e.Worker},blob:function(){return l.Blob},Uint8Array:function(){return e.Uint8Array},Uint32Array:function(){return e.Uint32Array},videoCodecs:function(){var e=n.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){}return t}()},noop:function(){},each:function(e,t){var i=void 0,n=void 0;if(l.isArray(e))for(i=-1,n=e.length;++i<n&&!1!==t(i,e[i]););else if(l.isObject(e))for(i in e)if(e.hasOwnProperty(i)&&!1===t(i,e[i]))break},mergeOptions:function(e,t){if(l.isObject(e)&&l.isObject(t)&&Object.keys){var i={};return l.each(e,function(t,n){i[t]=e[t]}),l.each(t,function(n,r){var o=t[n];l.isObject(o)&&e[n]?i[n]=l.mergeOptions(e[n],o):i[n]=o}),i}},setCSSAttr:function(e,t,i){l.isElement(e)&&(l.isString(t)&&l.isString(i)?e.style[t]=i:l.isObject(t)&&l.each(t,function(t,i){e.style[t]=i}))},removeElement:function(e){l.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!l.isString(e))return{};try{var t=new l.Blob([e],{type:"text/javascript"}),i=l.URL.createObjectURL(t);return{objectUrl:i,worker:new Worker(i)}}catch(e){return""+e}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{};if(!n.body||!1===e.resizeFont)return e.fontSize;var t=e.text,i=e.gifWidth,r=parseInt(e.fontSize,10),a=parseInt(e.minFontSize,10),s=n.createElement("div"),l=n.createElement("span");for(s.setAttribute("width",i),s.appendChild(l),l.innerHTML=t,l.style.fontSize=r+"px",l.style.textIndent="-9999px",l.style.visibility="hidden",n.body.appendChild(l);l.offsetWidth>i&&r>=a;)l.style.fontSize=--r+"px";return n.body.removeChild(l),r+"px"},webWorkerError:!1},c=Object.freeze({default:l}),d={validate:function(e){e=l.isObject(e)?e:{};var t={};return l.each(d.validators,function(i,n){var r=n.errorCode;if(!e[r]&&!n.condition)return(t=n).error=!0,!1}),delete t.condition,t},isValid:function(e){var t=!0!==d.validate(e).error;return t},validators:[{condition:l.isFunction(l.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:l.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:l.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:l.isFunction(l.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:l.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:l.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:l.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},u=Object.freeze({default:d}),p=function(){},m={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:p,completeCallback:p,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},f=Object.freeze({default:m});function g(){return d.isValid()}function h(){var e,t,i,n,r,o=256,a=499,s=491,l=487,c=503,d=3*c,u=o-1,p=4,m=100,f=16,g=1<<f,h=10,v=10,b=g>>v,S=g<<h-v,w=6,y=(o>>3)*(1<<w),x=30,q=1024,C=256,$=1<<18,k=[],O=[],M=[],E=[];function I(e,t,i,n,a){var s,l,c,d,u,p,m;for((c=t-e)<-1&&(c=-1),(d=t+e)>o&&(d=o),s=t+1,l=t-1,p=1;s<d||l>c;){if(u=E[p++],s<d){m=r[s++];try{m[0]-=u*(m[0]-i)/$|0,m[1]-=u*(m[1]-n)/$|0,m[2]-=u*(m[2]-a)/$|0}catch(e){}}if(l>c){m=r[l--];try{m[0]-=u*(m[0]-i)/$|0,m[1]-=u*(m[1]-n)/$|0,m[2]-=u*(m[2]-a)/$|0}catch(e){}}}}function U(e,t,i,n,o){var a=r[t],s=e/q;a[0]-=s*(a[0]-i)|0,a[1]-=s*(a[1]-n)|0,a[2]-=s*(a[2]-o)|0}function F(e,t,i){var n,a,s,l,c,d,u,m,g,w;for(g=m=~(1<<31),u=d=-1,n=0;n<o;n++)(a=(w=r[n])[0]-e)<0&&(a=-a),(s=w[1]-t)<0&&(s=-s),a+=s,(s=w[2]-i)<0&&(s=-s),(a+=s)<m&&(m=a,d=n),(l=a-(O[n]>>f-p))<g&&(g=l,u=n),c=M[n]>>v,M[n]-=c,O[n]+=c<<h;return M[d]+=b,O[d]-=S,u}(function(e,a,s){var l,c;for(t=e,i=a,n=s,r=new Array(o),l=0;l<o;l++)r[l]=new Array(4),(c=r[l])[0]=c[1]=c[2]=(l<<p+8)/o|0,M[l]=g/o|0,O[l]=0}).apply(this,arguments);var T={map:function(e,t,i){var n,a,s,l,c,d,u;for(c=1e3,u=-1,a=(n=k[t])-1;n<o||a>=0;)n<o&&((s=(d=r[n])[1]-t)>=c?n=o:(n++,s<0&&(s=-s),(l=d[0]-e)<0&&(l=-l),(s+=l)<c&&((l=d[2]-i)<0&&(l=-l),(s+=l)<c&&(c=s,u=d[3])))),a>=0&&((s=t-(d=r[a])[1])>=c?a=-1:(a--,s<0&&(s=-s),(l=d[0]-e)<0&&(l=-l),(s+=l)<c&&((l=d[2]-i)<0&&(l=-l),(s+=l)<c&&(c=s,u=d[3]))));return u}};return T.process=function(){return function(){var r,o,u,f,g,h,v,b,S,$,k,O,M,T;for(i<d&&(n=1),e=30+(n-1)/3,O=t,M=0,T=i,$=(k=i/(3*n))/m|0,b=q,(v=(h=y)>>w)<=1&&(v=0),r=0;r<v;r++)E[r]=b*((v*v-r*r)*C/(v*v));for(S=i<d?3:i%a!=0?3*a:i%s!=0?3*s:i%l!=0?3*l:3*c,r=0;r<k;)if(U(b,o=F(u=(255&O[M+0])<<p,f=(255&O[M+1])<<p,g=(255&O[M+2])<<p),u,f,g),0!==v&&I(v,o,u,f,g),(M+=S)>=T&&(M-=i),r++,0===$&&($=1),r%$==0)for(b-=b/e,(v=(h-=h/x)>>w)<=1&&(v=0),o=0;o<v;o++)E[o]=b*((v*v-o*o)*C/(v*v))}(),function(){var e;for(e=0;e<o;e++)r[e][0]>>=p,r[e][1]>>=p,r[e][2]>>=p,r[e][3]=e}(),function(){var e,t,i,n,a,s,l,c;for(l=0,c=0,e=0;e<o;e++){for(i=e,n=(a=r[e])[1],t=e+1;t<o;t++)(s=r[t])[1]<n&&(i=t,n=s[1]);if(s=r[i],e!=i&&(t=s[0],s[0]=a[0],a[0]=t,t=s[1],s[1]=a[1],a[1]=t,t=s[2],s[2]=a[2],a[2]=t,t=s[3],s[3]=a[3],a[3]=t),n!=l){for(k[l]=c+e>>1,t=l+1;t<n;t++)k[t]=e;l=n,c=e}}for(k[l]=c+u>>1,t=l+1;t<256;t++)k[t]=u}(),function(){for(var e=[],t=new Array(o),i=0;i<o;i++)t[r[i][3]]=i;for(var n=0,a=0;a<o;a++){var s=t[a];e[n++]=r[s][0],e[n++]=r[s][1],e[n++]=r[s][2]}return e}()},T}function v(){try{this.onmessage=function(t){var i,n=t.data||{};n.gifshot&&(i=e.run(n),postMessage(i))}}catch(e){}var e={dataToRGB:function(e,t,i){for(var n=t*i*4,r=0,o=[];r<n;)o.push(e[r++]),o.push(e[r++]),o.push(e[r++]),r++;return o},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],i=0;i<e.length;i+=3){var n=e[i],r=e[i+1],o=e[i+2];t.push(n<<16|r<<8|o)}return t},processFrameWithQuantizer:function(e,t,i,n){for(var r=this.dataToRGB(e,t,i),o=new h(r,r.length,n),a=o.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),l=t*i,c=new Uint8Array(l),d=0,u=0;u<l;u++){var p=r[d++],m=r[d++],f=r[d++];c[u]=o.map(p,m,f)}return{pixels:c,palette:s}},run:function(e){var t=e=e||{},i=t.height,n=(t.palette,t.sampleInterval),r=t.width,o=e.data;return this.processFrameWithQuantizer(o,r,i,n)}};return e}function b(e,t,i,n){var r=0,a=(n=n===o?{}:n).loop===o?null:n.loop,s=n.palette===o?null:n.palette;if(t<=0||i<=0||t>65535||i>65535)throw"Width/Height invalid.";e[r++]=71,e[r++]=73,e[r++]=70,e[r++]=56,e[r++]=57,e[r++]=97;if(e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=0|(null!==s?128:0),e[r++]=0,e[r++]=0,null!==a){if(a<0||a>65535)throw"Loop count invalid.";e[r++]=33,e[r++]=255,e[r++]=11,e[r++]=78,e[r++]=69,e[r++]=84,e[r++]=83,e[r++]=67,e[r++]=65,e[r++]=80,e[r++]=69,e[r++]=50,e[r++]=46,e[r++]=48,e[r++]=3,e[r++]=1,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=0}var l=!1;this.addFrame=function(t,i,n,a,c,d){if(!0===l&&(--r,l=!1),d=d===o?{}:d,t<0||i<0||t>65535||i>65535)throw"x/y invalid.";if(n<=0||a<=0||n>65535||a>65535)throw"Width/Height invalid.";if(c.length<n*a)throw"Not enough pixels for the frame size.";var u=!0,p=d.palette;if(p!==o&&null!==p||(u=!1,p=s),p===o||null===p)throw"Must supply either a local or global palette.";for(var m=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(p),f=0;m>>=1;)++f;m=1<<f;var g=d.delay===o?0:d.delay,h=d.disposal===o?0:d.disposal;if(h<0||h>3)throw"Disposal out of range.";var v=!1,b=0;if(d.transparent!==o&&null!==d.transparent&&(v=!0,(b=d.transparent)<0||b>=m))throw"Transparent color index.";if((0!==h||v||0!==g)&&(e[r++]=33,e[r++]=249,e[r++]=4,e[r++]=h<<2|(!0===v?1:0),e[r++]=255&g,e[r++]=g>>8&255,e[r++]=b,e[r++]=0),e[r++]=44,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=!0===u?128|f-1:0,!0===u)for(var S=0,w=p.length;S<w;++S){var y=p[S];e[r++]=y>>16&255,e[r++]=y>>8&255,e[r++]=255&y}r=function(e,t,i,n){e[t++]=i;var r=t++,a=1<<i,s=a-1,l=a+1,c=l+1,d=i+1,u=0,p=0;function m(i){for(;u>=i;)e[t++]=255&p,p>>=8,u-=8,t===r+256&&(e[r]=255,r=t++)}function f(e){p|=e<<u,u+=d,m(8)}var g=n[0]&s,h={};f(a);for(var v=1,b=n.length;v<b;++v){var S=n[v]&s,w=g<<8|S,y=h[w];if(y===o){for(p|=g<<u,u+=d;u>=8;)e[t++]=255&p,p>>=8,u-=8,t===r+256&&(e[r]=255,r=t++);4096===c?(f(a),c=l+1,d=i+1,h={}):(c>=1<<d&&++d,h[w]=c++),g=S}else g=y}f(g),f(l),m(1),r+1===t?e[r]=0:(e[r]=t-r-1,e[t++]=0);return t}(e,r,f<2?2:f,c)},this.end=function(){return!1===l&&(e[r++]=59,l=!0),r}}var S=function(){},w=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=S,this.onRenderProgressCallback=S,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};w.prototype={workerMethods:v(),initializeWebWorkers:function(e){var t,i=h.toString()+"("+v.toString()+"());",r=void 0,o=void 0,a=void 0,s=-1,c="";for(t=e.numWorkers;++s<t;)r=l.createWebWorker(i),l.isObject(r)?(o=r.objectUrl,a=r.worker,this.workers.push({worker:a,objectUrl:o}),this.availableWorkers.push(a)):(c=r,l.webWorkerError=!!r);this.workerError=c,this.canvas=n.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,i="",n=-1;++n<t;)i+=this.byteMap[e[n]];return i},onFrameFinished:function(e){var t=this,i=t.frames,n=!!(t.options.images||[]).length,r=i.every(function(e){return!e.beingProcessed&&e.done});t.numRenderedFrames++,n&&e(t.numRenderedFrames/i.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/i.length),r?t.generatingGIF||t.generateGIF(i,t.onRenderCompleteCallback):l.requestTimeout(function(){t.processNextFrame()},1)},processFrame:function(e){var t=this,i=(this.options,this.options),n=i.progressCallback,r=i.sampleInterval,a=this.frames,s=void 0,l=void 0,c=function(){var e=(arguments.length>0&&arguments[0]!==o?arguments[0]:{}).data;delete s.data,s.pixels=Array.prototype.slice.call(e.pixels),s.palette=Array.prototype.slice.call(e.palette),s.done=!0,s.beingProcessed=!1,t.freeWorker(l),t.onFrameFinished(n)};(s=a[e]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=r,s.beingProcessed=!0,s.gifshot=!0,(l=this.getWorker())?(l.onmessage=c,l.postMessage(s)):c({data:t.workerMethods.run(s)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var i=this.frames[t];if(!i.done&&!i.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var i=[],n={loop:this.repeat},r=this.options,o=r.interval,a=r.frameDuration,s=!!r.images.length,c=r.gifHeight,d=r.gifWidth,u=new b(i,d,c,n),p=this.onRenderProgressCallback,m=s?100*o:0,f=void 0;this.generatingGIF=!0,l.each(e,function(t,i){var n=i.palette;p(.75+.25*i.position*1/e.length);for(var r=0;r<a;r++)u.addFrame(0,0,d,c,i.pixels,{palette:n,delay:m})}),u.end(),p(1),this.frames=[],this.generatingGIF=!1,l.isFunction(t)&&(f=this.bufferToString(i),t("data:image/gif;base64,"+l.btoa(f)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t){t=l.isObject(t)?t:{};var i=this.ctx,n=this.options,r=n.gifWidth,o=n.gifHeight,a=l.getFontSize(t),s=t,c=s.filter,d=s.fontColor,u=s.fontFamily,p=s.fontWeight,m=(s.gifHeight,s.gifWidth,s.text),f=s.textAlign,g=s.textBaseline,h=t.textXCoordinate?t.textXCoordinate:"left"===f?1:"right"===f?r:r/2,v=t.textYCoordinate?t.textYCoordinate:"top"===g?1:"center"===g?o/2:o,b=p+" "+a+" "+u,S=void 0;try{i.filter=c,i.drawImage(e,0,0,r,o),m&&(i.font=b,i.fillStyle=d,i.textAlign=f,i.textBaseline=g,i.fillText(m,h,v)),S=i.getImageData(0,0,r,o),this.addFrameImageData(S)}catch(e){return""+e}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=this.frames,i=e.data;this.frames.push({data:i,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering(function(i){t.destroyWorkers(),l.requestTimeout(function(){e(i)},0)})},destroyWorkers:function(){if(!this.workerError){var e=this.workers;l.each(e,function(e,t){var i=t.worker,n=t.objectUrl;i.terminate(),l.URL.revokeObjectURL(n)})}}};var y=function(){},x={getGIF:function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=arguments[1];t=l.isFunction(t)?t:y;var i=n.createElement("canvas"),r=void 0,a=!!e.images.length,s=e.cameraStream,c=e.crop,d=e.filter,u=e.fontColor,p=e.fontFamily,m=e.fontWeight,f=e.keepCameraOn,g=(e.numWorkers,e.progressCallback),h=e.saveRenderingContexts,v=e.savedRenderingContexts,b=e.text,S=e.textAlign,x=e.textBaseline,q=e.videoElement,C=e.videoHeight,$=e.videoWidth,k=e.webcamVideoElement,O=Number(e.gifWidth),M=Number(e.gifHeight),E=Number(e.interval),I=(Number(e.sampleInterval),a?0:1e3*E),U=[],F=v.length?v.length:e.numFrames,T=F,A=new w(e),W=l.getFontSize(e),H=e.textXCoordinate?e.textXCoordinate:"left"===S?1:"right"===S?O:O/2,z=e.textYCoordinate?e.textYCoordinate:"top"===x?1:"center"===x?M/2:M,P=m+" "+W+" "+p,j=c?Math.floor(c.scaledWidth/2):0,D=c?$-c.scaledWidth:0,R=c?Math.floor(c.scaledHeight/2):0,L=c?C-c.scaledHeight:0;F=F!==o?F:10,E=E!==o?E:.1,i.width=O,i.height=M,r=i.getContext("2d"),function e(){v.length||0!==q.currentTime?function e(){var i=T-1;function n(){var n;h&&U.push(r.getImageData(0,0,O,M)),b&&(r.font=P,r.fillStyle=u,r.textAlign=S,r.textBaseline=x,r.fillText(b,H,z)),n=r.getImageData(0,0,O,M),A.addFrameImageData(n),g((F-(T=i))/F),i>0&&l.requestTimeout(e,I),T||A.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:s,videoElement:q,webcamVideoElement:k,savedRenderingContexts:U,keepCameraOn:f})})}v.length?(r.putImageData(v[F-T],0,0),n()):function e(){try{D>$&&(D=$),L>C&&(L=C),j<0&&(j=0),R<0&&(R=0),r.filter=d,r.drawImage(q,j,R,D,L,0,0,O,M),n()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;l.requestTimeout(e,100)}}()}():l.requestTimeout(e,100)}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=e.videoWidth,i=e.videoHeight,n=e.gifWidth,r=e.gifHeight,a={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>i?(a.width=Math.round(t*(r/i))-n,a.scaledWidth=Math.round(a.width*(i/r))):(a.height=Math.round(i*(n/t))-r,a.scaledHeight=Math.round(a.height*(t/n))),a}},q={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var i=t.cameraStream,n=t.completedCallback,r=t.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",q.findVideoSize),n({videoElement:r,cameraStream:i,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):e.attempts<10?(e.attempts+=1,l.requestTimeout(function(){q.findVideoSize(t)},400)):n({videoElement:r,cameraStream:i,videoWidth:q.defaultVideoDimensions.width,videoHeight:q.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){l.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=l.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,i=e.cameraStream,n=e.completedCallback,r=e.streamedCallback,o=e.videoElement;if(l.isFunction(r)&&r(),t){if(l.isString(t))o.src=t,o.innerHTML='<source src="'+t+'" type="video/'+l.getExtension(t)+'" />';else if(t instanceof Blob){try{o.src=l.URL.createObjectURL(t)}catch(e){}o.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=i;else if(l.URL)try{o.srcObject=i,o.src=l.URL.createObjectURL(i)}catch(e){o.srcObject=i}o.play(),l.requestTimeout(function e(){e.count=e.count||0,!0===q.loadedData?(q.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}),q.loadedData=!1):(e.count+=1)>10?q.findVideoSize({videoElement:o,cameraStream:i,completedCallback:n}):e()},0)},startStreaming:function(e){var t=l.isFunction(e.error)?e.error:l.noop,i=l.isFunction(e.streamed)?e.streamed:l.noop,r=l.isFunction(e.completed)?e.completed:l.noop,o=e.crossOrigin,a=e.existingVideo,s=e.lastCameraStream,c=e.options,d=e.webcamVideoElement,u=l.isElement(a)?a:d||n.createElement("video");o&&(u.crossOrigin=c.crossOrigin),u.autoplay=!0,u.loop=!0,u.muted=!0,u.addEventListener("loadeddata",function(e){q.loadedData=!0,c.offset&&(u.currentTime=c.offset)}),a?q.stream({videoElement:u,existingVideo:a,completedCallback:r}):s?q.stream({videoElement:u,cameraStream:s,streamedCallback:i,completedCallback:r}):l.getUserMedia({video:!0},function(e){q.stream({videoElement:u,cameraStream:e,streamedCallback:i,completedCallback:r})},t)},startVideoStreaming:function(e){var t=arguments.length>1&&arguments[1]!==o?arguments[1]:{},i=t.timeout!==o?t.timeout:0,n=t.callback,r=t.webcamVideoElement,a=void 0;i>0&&(a=l.requestTimeout(function(){q.onStreamingTimeout(n)},1e4)),q.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(a)},completed:function(){var t=arguments.length>0&&arguments[0]!==o?arguments[0]:{},i=t.cameraStream,n=t.videoElement,r=t.videoHeight,a=t.videoWidth;e({cameraStream:i,videoElement:n,videoHeight:r,videoWidth:a})},lastCameraStream:t.lastCameraStream,webcamVideoElement:r,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=e=l.isObject(e)?e:{},i=t.keepCameraOn,n=t.videoElement,r=t.webcamVideoElement,o=e.cameraStream||{},a=o.getTracks&&o.getTracks()||[],s=!!a.length,c=a[0];!i&&s&&l.isFunction(c.stop)&&c.stop(),l.isElement(n)&&!r&&(n.pause(),l.isFunction(l.URL.revokeObjectURL)&&!l.webWorkerError&&n.src&&l.URL.revokeObjectURL(n.src),l.removeElement(n))}};function C(e){e=l.isObject(e)?e:{},q.stopVideoStreaming(e)}function $(e,t){var i=e.options||{},r=i.images,o=i.video,a=Number(i.gifWidth),s=Number(i.gifHeight),c=(Number(i.numFrames),e.cameraStream),d=e.videoElement,u=e.videoWidth,p=e.videoHeight,m=x.getCropDimensions({videoWidth:u,videoHeight:p,gifHeight:s,gifWidth:a}),f=t;i.crop=m,i.videoElement=d,i.videoWidth=u,i.videoHeight=p,i.cameraStream=c,l.isElement(d)&&(d.width=a+m.width,d.height=s+m.height,i.webcamVideoElement||(l.setCSSAttr(d,{position:"fixed",opacity:"0"}),n.body.appendChild(d)),d.play(),x.getGIF(i,function(e){r&&r.length||o&&o.length||C(e),f(e)}))}function k(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var i=l.mergeOptions(m,e)||{},r=e.cameraStream,a=i.images,s=a?a.length:0,c=i.video,u=i.webcamVideoElement;i=l.mergeOptions(i,{gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),s?function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=e.callback,i=e.images,r=e.options,a=e.imagesLength,s=d.validate({getUserMedia:!0,"window.URL":!0}),c=[],u=0,p=void 0,m=void 0;if(s.error)return t(s);function f(){l.each(c,function(e,t){t&&(t.text?m.addFrame(t.img,r,t.text):m.addFrame(t,r))}),function(e,t){e.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})})}(m,t)}m=new w(r),l.each(i,function(e,i){var o=i;i.src&&(o=o.src),l.isElement(o)?(r.crossOrigin&&(o.crossOrigin=r.crossOrigin),c[e]=o,(u+=1)===a&&f()):l.isString(o)&&(p=new Image,r.crossOrigin&&(p.crossOrigin=r.crossOrigin),function(n){i.text&&(n.text=i.text),n.onerror=function(e){var i=void 0;if(0==--a)return(i={}).error="None of the requested images was capable of being retrieved",t(i)},n.onload=function(t){i.text?c[e]={img:n,text:n.text}:c[e]=n,(u+=1)===a&&f(),l.removeElement(n)},n.src=o}(p),l.setCSSAttr(p,{position:"fixed",opacity:"0"}),n.body.appendChild(p))})}({images:a,imagesLength:s,callback:t,options:i}):c?function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=e.callback,i=e.existingVideo,n=e.options,r=d.validate({getUserMedia:!0,"window.URL":!0}),a=void 0,s=void 0;if(r.error)return t(r);if(l.isElement(i)&&i.src){if(s=i.src,a=l.getExtension(s),!l.isSupported.videoCodecs[a])return t(d.messages.videoCodecs)}else l.isArray(i)&&l.each(i,function(e,t){if(a=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),l.isSupported.videoCodecs[a])return i=t,!1});q.startStreaming({completed:function(e){e.options=n||{},$(e,t)},existingVideo:i,crossOrigin:n.crossOrigin,options:n})}({existingVideo:c,callback:t,options:i}):function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{},t=e.callback,i=e.lastCameraStream,n=e.options,r=e.webcamVideoElement;if(!g())return t(d.validate());n.savedRenderingContexts.length?x.getGIF(n,function(e){t(e)}):q.startVideoStreaming(function(){var e=arguments.length>0&&arguments[0]!==o?arguments[0]:{};e.options=n||{},$(e,t)},{lastCameraStream:i,callback:t,webcamVideoElement:r,crossOrigin:n.crossOrigin})}({lastCameraStream:r,callback:t,webcamVideoElement:u,options:i})}}var O={utils:c,error:u,defaultOptions:f,createGIF:k,takeSnapShot:function(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var i=l.mergeOptions(m,e);k(l.mergeOptions(i,{interval:.1,numFrames:1,gifWidth:Math.floor(i.gifWidth),gifHeight:Math.floor(i.gifHeight)}),t)}},stopVideoStreaming:C,isSupported:function(){return d.isValid()},isWebCamGIFSupported:g,isExistingVideoGIFSupported:function(e){var t=!1;if(l.isArray(e)&&e.length){if(l.each(e,function(e,i){l.isSupported.videoCodecs[i]&&(t=!0)}),!t)return!1}else if(l.isString(e)&&e.length&&!l.isSupported.videoCodecs[e])return!1;return d.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return d.isValid({getUserMedia:!0})},VERSION:"0.4.5"};"function"==typeof define&&define.amd?define([],function(){return O}):void 0!==i?t.exports=O:e.gifshot=O}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},{}]},{},[1]);