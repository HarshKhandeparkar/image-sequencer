var defaultHtmlSequencerUi=require("./lib/sequencer/defaultHtmlSequencerUi"),setupCache=require("./lib/sw/cache.js"),DefaultHtmlStepUi=require("./lib/sequencer/defaultHtmlStepUi.js"),urlHash=require("./lib/sequencer/urlHash.js"),gifshot=require("gifshot"),initComponents=require("./lib/DOM/initializeComponents"),initializeSelect=initComponents.initializeSelect,initializeModal=initComponents.initializeModal,insertPreview=require("./lib/DOM/insertPreview.js");window.onload=function(){function e(){var e=sequencer.modulesInfo(),t=$("#selectStep");for(var i in t.html(""),e)e[i]&&e[i].name&&t.append('<option value="'+i+'">'+e[i].name+"</option>");t.append('<label value="none" disabled selected>More modules...</label>')}sequencer=ImageSequencer(),$(document).on("keydown",function(e){String.fromCharCode(e.which)}),e(),$(window).on("scroll",function(){var e=$("body").scrollTop()>20||$(":root").scrollTop()>20;$("#move-up").css({display:e?"block":"none"})}),$("#move-up").on("click",function(){$("body").animate({scrollTop:0}),$(":root").animate({scrollTop:0})}),sequencer.setUI(DefaultHtmlStepUi(sequencer));var t=defaultHtmlSequencerUi(sequencer);urlHash.getUrlHashParameter("src")?sequencer.loadImage(urlHash.getUrlHashParameter("src"),t.onLoad):sequencer.loadImage("images/tulips.png",t.onLoad);$("#addStep select").on("change",t.selectNewStepUi),$("#addStep #add-step-btn").on("click",t.addStepUi),$("#resetButton").on("click",function(){confirm("Do you want to reset the sequence?")&&(window.location="/")}),$(".radio-group .radio").on("click",function(){$(this).parent().find(".radio").removeClass("selected"),$(this).addClass("selected"),newStep=$(this).attr("data-value"),$("#addStep select").val(newStep),t.selectNewStepUi(),t.addStepUi(),$(this).removeClass("selected")}),$("#download-btn").click(function(){return download($(".step-thumbnail:last()").attr("src"),$(".step-thumbnail:last()").attr("alt")+".png","image/png"),!1}),$("body").on("click","button.remove",t.removeStepUi),$("#save-seq").click(()=>{var t=window.prompt("Please give a name to your sequence... (Saved sequence will only be available in this browser).");t&&(t+=" (local)",sequencer.saveSequence(t,sequencer.toString()),sequencer.loadModules(),$(".savesequencemsg").fadeIn(),setTimeout(function(){$(".savesequencemsg").fadeOut()},1e3),e())});var i=!1;$(".js-view-as-gif").on("click",function(e){if(!i){i=!0;var t=e.target;t.disabled=!0;try{for(var n=document.getElementsByClassName("step-thumbnail"),a=[],s=0;s<n.length;s++)a.push(n[s].src);var o={gifWidth:n[0].width,gifHeight:n[0].height,images:a,frameDuration:7};gifshot.createGIF(o,function(e){if(!e.error){var n=e.image,a=document.createElement("img");a.classList.add("responsive-img"),a.src=n;var s=$("#js-download-gif-modal");$("#js-download-as-gif-button").one("click",function(){s.modal("close"),download(n,"index.gif","image/gif")}),$(".gif-close").click(function(){s.modal("close")});var o=document.getElementById("js-download-modal-gif-container");o.innerHTML="",o.appendChild(a),s.modal("open"),t.disabled=!1,i=!1}})}catch(e){console.error(e),t.disabled=!1,i=!1}}}),sequencer.setInputStep({dropZoneSelector:"#dropzone",fileInputSelector:"#fileInput",takePhotoSelector:"#take-photo",onLoad:function(e){var t=e.target,i=sequencer.images.image1.steps[0];IntermediateHtmlStepUi(sequencer);i.output.src=t.result,sequencer.run({index:0}),i.options.step.imgElement.src=t.result,insertPreview.updatePreviews(t.result,"#addStep"),insertPreview.updatePreviews(sequencer.images.image1.steps[0].options.step.imgElement.src,".insert-step")},onTakePhoto:function(e){var t=sequencer.images.image1.steps[0];t.output.src=e,sequencer.run({index:0}),t.options.step.imgElement.src=e}}),setupCache(),urlHash.getUrlHashParameter("src")?insertPreview.updatePreviews(urlHash.getUrlHashParameter("src"),"#addStep"):insertPreview.updatePreviews("images/tulips.png","#addStep"),initializeSelect(),initializeModal()};