var defaultHtmlSequencerUi=require("./lib/defaultHtmlSequencerUi.js"),setupCache=require("./lib/cache.js"),DefaultHtmlStepUi=require("./lib/defaultHtmlStepUi.js"),urlHash=require("./lib/urlHash.js"),insertPreview=require("./lib/insertPreview.js");window.onload=function(){function e(){var e=sequencer.modulesInfo(),t=$("#addStep select");for(var n in t.html(""),e)e[n]&&e[n].name&&t.append('<option value="'+n+'">'+e[n].name+"</option>");t.append('<option value="none" disabled selected>More modules...</option>')}sequencer=ImageSequencer(),$("button#new-ui").on("click",function(){var e=window.location.toString(),t=e.substr(0,e.indexOf("examples/")+9)+"new/#steps="+urlHash.getUrlHashParameter("steps");window.location=t}),e(),$(window).on("scroll",function(){var e=$("body").scrollTop()>20||$(":root").scrollTop()>20;$("#move-up").css({display:e?"block":"none"})}),$("#move-up").on("click",function(){$("body").animate({scrollTop:0}),$(":root").animate({scrollTop:0})}),sequencer.setUI(DefaultHtmlStepUi(sequencer));var t=defaultHtmlSequencerUi(sequencer);urlHash.getUrlHashParameter("src")?sequencer.loadImage(urlHash.getUrlHashParameter("src"),t.onLoad):sequencer.loadImage("images/tulips.png",t.onLoad);$("#addStep select").on("change",t.selectNewStepUi),$("#addStep #add-step-btn").on("click",t.addStepUi),$("#resetButton").on("click",function(){confirm("Do you want to reset the sequence?")&&(window.location="/")}),$(".radio-group .radio").on("click",function(){$(this).parent().find(".radio").removeClass("selected"),$(this).addClass("selected"),newStep=$(this).attr("data-value"),$("#addStep select").val(newStep),t.selectNewStepUi(),t.addStepUi(),$(this).removeClass("selected")}),$("#download-btn").click(function(){return $(".step-thumbnail:last()").trigger("click"),!1}),$("body").on("click","button.remove",t.removeStepUi),$("#save-seq").click(()=>{var t=window.prompt("Please give a name to your sequence... (Saved sequence will only be available in this browser).");t&&(t+=" (local)",sequencer.saveSequence(t,sequencer.toString()),sequencer.loadModules(),$(".savesequencemsg").fadeIn(),setTimeout(function(){$(".savesequencemsg").fadeOut()},1e3),e())});var n=!1;$(".js-view-as-gif").on("click",function(e){if(!n){n=!0;var t=e.target;t.disabled=!0;try{for(var a=document.getElementsByClassName("step-thumbnail"),s=[],r=0;r<a.length;r++)s.push(a[r].src);var i={gifWidth:a[0].width,gifHeight:a[0].height,images:s,frameDuration:7};gifshot.createGIF(i,function(e){if(!e.error){var a=e.image,s=document.createElement("img");s.id="gif_element",s.src=a;var r=$("#js-download-gif-modal");$("#js-download-as-gif-button").one("click",function(){download(a,"index.gif","image/gif"),r.modal("hide")});var i=document.getElementById("js-download-modal-gif-container");i.innerHTML="",i.appendChild(s),r.modal(),t.disabled=!1,n=!1}})}catch(e){console.error(e),t.disabled=!1,n=!1}}}),sequencer.setInputStep({dropZoneSelector:"#dropzone",fileInputSelector:"#fileInput",takePhotoSelector:"#take-photo",onLoad:function(e){var t=e.target,n=sequencer.images.image1.steps[0];IntermediateHtmlStepUi(sequencer);n.output.src=t.result,sequencer.run({index:0}),n.options.step.imgElement.src=t.result,insertPreview.updatePreviews(t.result,"addStep"),insertPreview.updatePreviews(sequencer.images.image1.steps[0].options.step.imgElement.src,"insertStep")},onTakePhoto:function(e){var t=sequencer.images.image1.steps[0];t.output.src=e,sequencer.run({index:0}),t.options.step.imgElement.src=e}}),setupCache(),urlHash.getUrlHashParameter("src")?insertPreview.updatePreviews(urlHash.getUrlHashParameter("src"),"addStep"):insertPreview.updatePreviews("images/tulips.png","addStep")};